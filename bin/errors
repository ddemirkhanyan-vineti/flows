#!/usr/bin/env ruby

require 'bundler/setup'
require 'flows'

require 'pry'
require 'gli'

require_relative 'errors_cli/contract_error_demo'
require_relative 'errors_cli/flows_router_error_demo'
require_relative 'errors_cli/di_error_demo'
require_relative 'errors_cli/oc_error_demo'

class ErrorsCLI
  extend GLI::App

  program_desc 'Error reporting demo'

  use_openstruct true

  desc 'Flows::Contract error'
  command :contract do |cmd|
    cmd.action do |_, _, _|
      ContractErrorDemo.call
    end
  end

  desc 'Flows::Flow::Router::NoRouteError'
  command :flows_router do |cmd|
    cmd.action do |_, _, _|
      FlowsRouterErrorDemo.call
    end
  end

  desc 'Flows::Plugin::DependencyInjector errors'
  command :di do |cmd|
    cmd.desc 'Missing Dependency'
    cmd.command :missing do |icmd|
      icmd.action do |_, _, _|
        DIErrorDemo.missing_dependency
      end
    end

    cmd.desc 'Unexpected Dependency'
    cmd.command :unexpected do |icmd|
      icmd.action do |_, _, _|
        DIErrorDemo.unexpected_dependency
      end
    end

    cmd.desc 'Invalid Type'
    cmd.command :invalid_type do |icmd|
      icmd.action do |_, _, _|
        DIErrorDemo.invalid_type_dependency
      end
    end

    cmd.desc 'Missing Default'
    cmd.command :missing_default do |icmd|
      icmd.action do |_, _, _|
        DIErrorDemo.missing_default
      end
    end
  end

  desc 'OutputContract plugin errors'
  command :output_contract do |cmd|
    cmd.desc 'No Contract error'
    cmd.command :no_contract do |icmd|
      icmd.action do |_, _, _|
        OCErrorDemo.no_contract
      end
    end

    cmd.desc 'Contract error'
    cmd.command :contract_error do |icmd|
      icmd.action do |_, _, _|
        OCErrorDemo.contract_error
      end
    end

    cmd.desc 'Status error'
    cmd.command :status_error do |icmd|
      icmd.action do |_, _, _|
        OCErrorDemo.status_error
      end
    end

    cmd.desc 'Result type error'
    cmd.command :result_type_error do |icmd|
      icmd.action do |_, _, _|
        OCErrorDemo.result_type_error
      end
    end
  end
end

exit ErrorsCLI.run(ARGV)
